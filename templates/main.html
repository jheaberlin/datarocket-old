{% load static %}

<!DOCTYPE html>
<html lang="en" class="h-full bg-gray-100">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Datarocket</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
  <div class="min-h-full">
    <aside class="fixed top-0 left-0 w-60 h-full bg-white border-r border-gray-200" aria-label="Sidenav">
      <div
        class="overflow-y-auto py-5 px-3 h-full bg-white">
        <ul class="space-y-2">
          <li class="mb-4">
            <a href="{% url 'home' %}"
              class="flex items-center p-2 text-xl font-semibold text-gray-900 rounded-lg hover:bg-gray-200 group">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
                <path fill-rule="evenodd" d="M4.606 12.97a.75.75 0 01-.134 1.051 2.494 2.494 0 00-.93 2.437 2.494 2.494 0 002.437-.93.75.75 0 111.186.918 3.995 3.995 0 01-4.482 1.332.75.75 0 01-.461-.461 3.994 3.994 0 011.332-4.482.75.75 0 011.052.134z" clip-rule="evenodd" />
                <path fill-rule="evenodd" d="M5.752 12A13.07 13.07 0 008 14.248v4.002c0 .414.336.75.75.75a5 5 0 004.797-6.414 12.984 12.984 0 005.45-10.848.75.75 0 00-.735-.735 12.984 12.984 0 00-10.849 5.45A5 5 0 001 11.25c.001.414.337.75.751.75h4.002zM13 9a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" />
              </svg>                       
              <span class="ml-3">Datarocket</span>
            </a>
          </li>
          <li>
            <a href="{% url 'home' %}"
              class="flex items-center p-2 text-sm font-semibold rounded-lg hover:bg-gray-200 group {% if page == 'home'%} bg-gray-200 text-gray-900{%else%}text-gray-500{%endif%}">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
                <path fill-rule="evenodd" d="M9.293 2.293a1 1 0 011.414 0l7 7A1 1 0 0117 11h-1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-3a1 1 0 00-1-1H9a1 1 0 00-1 1v3a1 1 0 01-1 1H5a1 1 0 01-1-1v-6H3a1 1 0 01-.707-1.707l7-7z" clip-rule="evenodd" />
              </svg>                                      
              <span class="ml-3">Home</span>
            </a>
          </li>
          <li>
            <a href="{% url 'launches' %}"
            class="flex items-center p-2 text-sm font-semibold rounded-lg hover:bg-gray-200 group {% if page == 'launches'%} bg-gray-200 {%else%}text-gray-500{%endif%}">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
                <path fill-rule="evenodd" d="M4.606 12.97a.75.75 0 01-.134 1.051 2.494 2.494 0 00-.93 2.437 2.494 2.494 0 002.437-.93.75.75 0 111.186.918 3.995 3.995 0 01-4.482 1.332.75.75 0 01-.461-.461 3.994 3.994 0 011.332-4.482.75.75 0 011.052.134z" clip-rule="evenodd" />
                <path fill-rule="evenodd" d="M5.752 12A13.07 13.07 0 008 14.248v4.002c0 .414.336.75.75.75a5 5 0 004.797-6.414 12.984 12.984 0 005.45-10.848.75.75 0 00-.735-.735 12.984 12.984 0 00-10.849 5.45A5 5 0 001 11.25c.001.414.337.75.751.75h4.002zM13 9a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" />
              </svg>              
              <span class="flex-1 ml-3 whitespace-nowrap">Launches</span>
            </a>
          </li>
          <li>
            <a href="{% url 'endpoints' %}"
            class="flex items-center p-2 text-sm font-semibold rounded-lg hover:bg-gray-200 group {% if page == 'endpoints'%} bg-gray-200 {%else%}text-gray-500{%endif%}">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
              <path d="M16.555 5.412a8.028 8.028 0 00-3.503-2.81 14.899 14.899 0 011.663 4.472 8.547 8.547 0 001.84-1.662zM13.326 7.825a13.43 13.43 0 00-2.413-5.773 8.087 8.087 0 00-1.826 0 13.43 13.43 0 00-2.413 5.773A8.473 8.473 0 0010 8.5c1.18 0 2.304-.24 3.326-.675zM6.514 9.376A9.98 9.98 0 0010 10c1.226 0 2.4-.22 3.486-.624a13.54 13.54 0 01-.351 3.759A13.54 13.54 0 0110 13.5c-1.079 0-2.128-.127-3.134-.366a13.538 13.538 0 01-.352-3.758zM5.285 7.074a14.9 14.9 0 011.663-4.471 8.028 8.028 0 00-3.503 2.81c.529.638 1.149 1.199 1.84 1.66zM17.334 6.798a7.973 7.973 0 01.614 4.115 13.47 13.47 0 01-3.178 1.72 15.093 15.093 0 00.174-3.939 10.043 10.043 0 002.39-1.896zM2.666 6.798a10.042 10.042 0 002.39 1.896 15.196 15.196 0 00.174 3.94 13.472 13.472 0 01-3.178-1.72 7.973 7.973 0 01.615-4.115zM10 15c.898 0 1.778-.079 2.633-.23a13.473 13.473 0 01-1.72 3.178 8.099 8.099 0 01-1.826 0 13.47 13.47 0 01-1.72-3.178c.855.151 1.735.23 2.633.23zM14.357 14.357a14.912 14.912 0 01-1.305 3.04 8.027 8.027 0 004.345-4.345c-.953.542-1.971.981-3.04 1.305zM6.948 17.397a8.027 8.027 0 01-4.345-4.345c.953.542 1.971.981 3.04 1.305a14.912 14.912 0 001.305 3.04z" />
            </svg>            
              <span class="ml-3">Endpoints</span>
            </a>
          </li>
          <li>
            <a href="#"
            class="flex items-center p-2 text-sm font-semibold rounded-lg hover:bg-gray-200 group {% if page == 'help'%} bg-gray-200 {%else%}text-gray-500{%endif%}">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
              <path fill-rule="evenodd" d="M7.171 4.146l1.947 2.466a3.514 3.514 0 011.764 0l1.947-2.466a6.52 6.52 0 00-5.658 0zm8.683 3.025l-2.466 1.947c.15.578.15 1.186 0 1.764l2.466 1.947a6.52 6.52 0 000-5.658zm-3.025 8.683l-1.947-2.466c-.578.15-1.186.15-1.764 0l-1.947 2.466a6.52 6.52 0 005.658 0zM4.146 12.83l2.466-1.947a3.514 3.514 0 010-1.764L4.146 7.171a6.52 6.52 0 000 5.658zM5.63 3.297a8.01 8.01 0 018.738 0 8.031 8.031 0 012.334 2.334 8.01 8.01 0 010 8.738 8.033 8.033 0 01-2.334 2.334 8.01 8.01 0 01-8.738 0 8.032 8.032 0 01-2.334-2.334 8.01 8.01 0 010-8.738A8.03 8.03 0 015.63 3.297zm5.198 4.882a2.008 2.008 0 00-2.243.407 1.994 1.994 0 00-.407 2.243 1.993 1.993 0 00.992.992 2.008 2.008 0 002.243-.407c.176-.175.31-.374.407-.585a2.008 2.008 0 00-.407-2.243 1.993 1.993 0 00-.585-.407z" clip-rule="evenodd" />
            </svg>                          
              <span class="ml-3">Help</span>
            </a>
          </li>
        </ul>
      </div>
      <div
        class="hidden absolute bottom-0 left-0 justify-start p-4 space-x-4 w-full lg:flex bg-white z-20">
        <a href="{% url 'logout' %}" data-tooltip-target="tooltip-settings"
          class="inline-flex justify-center p-2 text-gray-500 rounded cursor-pointer hover:text-gray-900 hover:bg-gray-100">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75" />
          </svg>
          <span class="ml-4 overflow-clip">
          {{ user.email }}   
          </span>       
        </a>
        <div id="tooltip-settings" role="tooltip"
          class="inline-block absolute invisible z-10 py-2 px-3 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-sm opacity-0 transition-opacity duration-300 tooltip">
          Logout
          <div class="tooltip-arrow" data-popper-arrow></div>
        </div>
      </div>
    </aside>
    <main>
      <div class="pl-60 m-6">
        <form action="{% if user.stripe_plan_active == True%}{% url 'create_portal_session' %}{% else %} {% url 'stripe_checkout' %} {% endif %}" method="POST">
          {% csrf_token %}
          <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
            {% if user.stripe_plan_active == True%}
            Manage Subscription
            {%else%}
            Subscribe
            {%endif%}
          </button>
        </form>
        <p>{{plan}}</p>
        {% block content %}

        {% endblock content %}
      </div>
      <div id="createPushModal" tabindex="-1" aria-hidden="true"
        class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-modal md:h-full">
        <div class="relative p-4 w-full max-w-2xl h-full md:h-auto">
          <div class="relative p-4 bg-white rounded-lg shadow sm:p-5">
            <div class="flex justify-between items-center pb-4 mb-4 rounded-t border-b sm:mb-5">
              <h3 class="text-lg font-semibold text-gray-900">
                Start a Launch
              </h3>
              <button type="button"
                class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center"
                data-modal-toggle="createPushModal">
                <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                  xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd"
                    d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                    clip-rule="evenodd"></path>
                </svg>
                <span class="sr-only">Close modal</span>
              </button>
            </div>
            <form enctype="multipart/form-data" method="POST" action="{% url 'createPush' page=page %}">
              {% csrf_token %}
              <div class="grid grid-cols-2 gap-4 mb-4">
                <div>
                  <label for="name"
                    class="block mb-2 text-sm font-medium text-gray-900">Description</label>
                  <input type="text" name="description" id="description"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"
                    placeholder="Enter a description of this Launch" required="yes">
                </div>
                <div>
                  <label for="name"
                    class="block mb-2 text-sm font-medium text-gray-900">Workers</label>
                  <input type="number" name="workers" id="workers"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"
                    placeholder="i.e. 15" required="yes">
                </div>
                <div class="col-span-2">
                  <label for="endpoint"
                    class="block mb-2 text-sm font-medium text-gray-900">Endpoint</label>
                  <select id="endpoint" name="endpoint"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5"
                    required="yes">
                    <option selected="">Select an endpoint</option>
                    {% for endpoint in endpoints %}
                    <option value="{{endpoint.id}}">{{endpoint.description}}</option>
                    {% endfor %}
                  </select>
                </div>
                <div class="col-span-2" x-data="{ files: null }">
                  <label
                    class="flex justify-center w-full h-32 px-4 transition bg-white border-2 border-gray-300 border-dashed rounded-md appearance-none cursor-pointer hover:border-gray-400 focus:outline-none">
                    <template x-if="files == null">
                      <span class="flex items-center space-x-2">
                        <span class="font-medium text-gray-600">
                          Drop a JSON file here or
                          <span class="text-blue-600 underline">browse for one</span>
                        </span>
                      </span>
                    </template>
                    <template x-if="files !== null">
                      <template x-for="(_,index) in Array.from({ length: files.length })">
                        <span class="flex items-center space-x-2">
                          <span class="font-medium text-gray-600" x-text="files[index].name">
                            Uploading...
                          </span>
                      </template>
                    </template>
                    <input required="yes" type="file" name="json" class="hidden" accept=".json"
                      x-on:change="files = $event.target.files; console.log($event.target.files);"
                      x-on:dragover="$el.classList.add('active')" x-on:dragleave="$el.classList.remove('active')"
                      x-on:drop="$el.classList.remove('active')">
                  </label>
                </div>
              </div>
              <div class="flex justify-end">
                <button
                  class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center"
                  type="submit">
                  Start Launch
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
      <div id="createEndpointModal" tabindex="-1" aria-hidden="true"
        class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-modal md:h-full">
        <div class="relative p-4 w-full max-w-2xl h-full md:h-auto">
          <div class="relative p-4 bg-white rounded-lg shadow sm:p-5">
            <div class="flex justify-between items-center pb-4 mb-4 rounded-t border-b sm:mb-5">
              <h3 class="text-lg font-semibold text-gray-900">
                Create an Endpoint
              </h3>
              <button type="button"
                class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center"
                data-modal-toggle="createEndpointModal">
                <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                  xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd"
                    d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                    clip-rule="evenodd"></path>
                </svg>
                <span class="sr-only">Close modal</span>
              </button>
            </div>
            <form enctype="multipart/form-data" method="POST" action="{% url 'createEndpoint' page=page %}">
              {% csrf_token %}
              <div class="grid grid-cols-1 gap-4 mb-4">
                <div>
                  <label for="name"
                    class="block mb-2 text-sm font-medium text-gray-900">Name</label>
                  <input type="text" name="description" id="description"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"
                    placeholder="My Data Type Name" required="yes">
                </div>
                <div>
                  <label for="url" class="block mb-2 text-sm font-medium text-gray-900">Endpoint
                    URL</label>
                  <input type="url" name="url" id="url"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"
                    placeholder="https://myapp.bubbleapps.io/api/1.1/obj/mydatatype/bulk" required="yes">
                </div>
              </div>
              <div class="flex justify-end">
                <button
                  class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center"
                  type="submit">
                  Save Endpoint
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </main>
  </div>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.2/flowbite.min.js"></script>
</body>

</html>